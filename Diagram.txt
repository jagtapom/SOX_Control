┌────────────────────────────┐
│     Outlook / O365         │
│  (User Mailboxes)          │
└───────────┬────────────────┘
            │ OAuth 2.0 (App + Cert)
            ▼
┌────────────────────────────┐
│ Microsoft Graph API        │
└───────────┬────────────────┘
            │ HTTPS (TLS 1.2+)
            ▼
┌────────────────────────────────────────────┐
│ AWS VPC (Private Subnets)                   │
│                                            │
│ ┌────────────────────────────────────────┐ │
│ │ Lambda / EKS Evidence Ingestor          │ │
│ │ - Fetch emails                          │ │
│ │ - Convert to .eml                      │ │
│ │ - Push to encrypted S3                 │ │
│ └───────────┬────────────────────────────┘ │
│             │                               │
│ ┌───────────▼────────────────────────────┐ │
│ │ Recursive Evidence Processor            │ │
│ │ - Email parsing                         │ │
│ │ - Attachment extraction                │ │
│ │ - Depth control + hashing               │ │
│ └───────────┬────────────────────────────┘ │
│             │                               │
│ ┌───────────▼────────────────────────────┐ │
│ │ OCR Layer                               │ │
│ │ - AWS Textract                          │ │
│ └───────────┬────────────────────────────┘ │
│             │                               │
│ ┌───────────▼────────────────────────────┐ │
│ │ NLP / Understanding                    │ │
│ │ - AWS Bedrock (Claude / Nova)          │ │
│ └───────────┬────────────────────────────┘ │
│             │                               │
│ ┌───────────▼────────────────────────────┐ │
│ │ Evidence Store                          │ │
│ │ - S3 (SSE-KMS)                          │ │
│ │ - DynamoDB (metadata, lineage)          │ │
│ │ - OpenSearch (optional search)          │ │
│ └────────────────────────────────────────┘ │
└────────────────────────────────────────────┘
